<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Orange</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <p id="contents">Use your iOS or Android smartphone to open the Orange app and login.</p>

        <script type="text/javascript">
            "use strict";

            // code to open custom URL scheme on mobile devices
            var APP_URL = "orangeapp://login";
            // TODO use actual app store/play store URLs once in production
            var APPSTORE_URL = "https://aironapp.arello-mobile.com/ota/nxqsurwu";
            var PLAYSTORE_URL = "https://owncloud.arello-mobile.com/index.php/s/m2N6lLixXlWYXpi";
            var IOS_LOADING_TEXT = "Please wait, the Orange app is opening...";
            var ANDROID_LOADING_TEXT = IOS_LOADING_TEXT;

            // platform detection
            // based upon http://fokkezb.nl/2013/09/20/url-schemes-for-ios-and-android-2/
            var IS_IPAD = navigator.userAgent.match(/iPad/i) !== null,
                IS_IPHONE = !IS_IPAD && ((navigator.userAgent.match(/iPhone/i) !== null) || (navigator.userAgent.match(/iPod/i) !== null)),
                IS_IOS = IS_IPAD || IS_IPHONE,
                IS_ANDROID = !IS_IOS && navigator.userAgent.match(/android/i) !== null;

            if (IS_IOS) {
                window.location = APP_URL;
                // open the app store to Orange if the user doesn't have it installed
                setTimeout(function() {
                    if (!document.webkitHidden) {
                        window.location = APPSTORE_URL;
                    }
                }, 25);
                
                // display helpful text
                document.getElementById("contents").innerHTML = IOS_LOADING_TEXT;
            } else if (IS_ANDROID) {
                document.location = APP_URL;
                // open the play store to Orange if the user doesn't have it installed
                setTimeout(function() {
                    document.location = PLAYSTORE_URL;
                }, 250);

                // display helpful text
                document.getElementById("contents").innerHTML = ANDROID_LOADING_TEXT;
            }
        </script>
    </body>
</html>
